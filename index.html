<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard Absensi</title>
<style>
body{font-family:Arial;background:#f2f2f2;text-align:center}
table{border-collapse:collapse;margin:auto;background:#fff}
th,td{border:1px solid #ccc;padding:6px 10px}
th{background:#2196F3;color:white}
</style>
</head>
<body>

<h2>Status Sistem</h2>
<div id="status">Loading...</div>

<h2>Data Absensi</h2>
<table id="tabel">
<tr><th>Nama</th><th>Divisi</th><th>Status</th><th>Waktu</th></tr>
</table>

<script>
const ESP_IP = "http://192.168.1.8"; // WAJIB pakai http lengkap

function loadStatus() {
  fetch(`${ESP_IP}/api/status`)
  .then(r=>r.json())
  .then(d=>{
    document.getElementById("status").innerHTML =
      "WiFi: "+d.wifi+" | SD: "+d.sd+" | IP: "+d.ip;
  });
}

function loadAbsensi() {
  fetch(`${ESP_IP}/api/absensi`)
  .then(r=>r.json())
  .then(data=>{
    let t = document.getElementById("tabel");
    t.innerHTML = "<tr><th>Nama</th><th>Divisi</th><th>Status</th><th>Waktu</th></tr>";

    data.forEach(row=>{
      let tr = document.createElement("tr");
      tr.innerHTML = `<td>${row.nama}</td><td>${row.divisi}</td><td>${row.status}</td><td>${row.waktu}</td>`;
      t.appendChild(tr);
    });
  });
}

loadStatus();
loadAbsensi();
setInterval(loadStatus, 5000);
setInterval(loadAbsensi, 5000);
</script>



</body>
</html>
